(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b7a0b08"],{"06b8":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"publish-questionnaire"},[i("Modal",{attrs:{"footer-hide":!0},model:{value:t.showCreaterDialog,callback:function(e){t.showCreaterDialog=e},expression:"showCreaterDialog"}},[i("question-form",{attrs:{inputContent:t.plainContent,mode:"create"},on:{createNewQuestion:t.newQuestionHandler}})],1),i("div",{staticStyle:{position:"fixed",bottom:"4vh","z-index":"100"}},[i("Button",{attrs:{type:"primary",icon:"md-add",shape:"circle",size:"large"},on:{click:t.createQuestion}})],1),i("h1",{staticStyle:{"margin-top":"1rem","margin-bottom":"2rem","text-align":"center"}},[t._v("创建你的问卷")]),i("div",{staticClass:"title-wrapper"},[i("h3",{staticStyle:{"margin-bottom":"1rem"}},[t._v("标题")]),i("Input",{staticStyle:{width:"45%","min-width":"400px","max-width":"500px"},attrs:{type:"text",placeholder:"请输入问卷标题",size:"large"},model:{value:t.currentQuestionnaire.title,callback:function(e){t.$set(t.currentQuestionnaire,"title",e)},expression:"currentQuestionnaire.title"}}),i("h3",{staticStyle:{margin:"1rem 0 1rem 0"}},[t._v("描述")]),i("Input",{staticStyle:{width:"45%","min-width":"400px","max-width":"500px"},attrs:{type:"textarea",rows:4,placeholder:"请输入问卷描述"},model:{value:t.currentQuestionnaire.summary,callback:function(e){t.$set(t.currentQuestionnaire,"summary",e)},expression:"currentQuestionnaire.summary"}})],1),i("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"45%","min-width":"400px","max-width":"500px",margin:"0 auto"}},[i("div",{staticClass:"bounty-wrapper",staticStyle:{width:"70%"}},[i("h3",{staticStyle:{"margin-bottom":"1rem"}},[t._v("报酬")]),i("Input",{attrs:{prefix:"logo-usd",size:"large"},model:{value:t.currentQuestionnaire.bounty,callback:function(e){t.$set(t.currentQuestionnaire,"bounty",e)},expression:"currentQuestionnaire.bounty"}})],1),i("div",{staticClass:"limit-wrapper",staticStyle:{width:"25%"}},[i("h3",{staticStyle:{"margin-bottom":"1rem"}},[t._v("人数限制")]),i("InputNumber",{staticStyle:{width:"100%"},attrs:{size:"large",max:400,min:1},model:{value:t.currentQuestionnaire.limit,callback:function(e){t.$set(t.currentQuestionnaire,"limit",e)},expression:"currentQuestionnaire.limit"}})],1)]),i("div",{staticClass:"questions-wrapper"},[0===t.currentQuestionnaire.content.length?i("h3",{staticStyle:{"text-align":"center",height:"180px",display:"flex","align-items":"center","justify-content":"center","vertical-align":"middle"}},[i("span",[t._v("你的问卷还没有任何问题哦，点击左下方的“+”按钮创建吧！")])]):i("h3",[t._v("问题")]),t._l(t.currentQuestionnaire.content,function(e,n){return i("Card",{key:"content"+n+Math.random(),staticStyle:{margin:"1rem 0 0 0",width:"45%","min-width":"400px","max-width":"500px"},attrs:{"dis-hover":!0}},[i("div",{staticStyle:{width:"100%",display:"flex","justify-content":"flex-end"}},[i("Button",{staticStyle:{padding:"0"},attrs:{type:"text",icon:"md-close"},on:{click:function(e){return t.delQuestion(n)}}})],1),i("question-form",{attrs:{inputContent:e,mode:"edit",index:n},on:{modifyQuestion:t.modifyQuestionHandler}})],1)})],2),t.questionnaireExisted?i("div",{staticClass:"submit-btn-wrapper"},[i("Button",{staticStyle:{"margin-right":"1rem"},on:{click:function(e){t.showFinishDialog=!0}}},[t._v("结束任务")]),i("Button",{staticStyle:{"margin-right":"1rem"},attrs:{type:"info"},on:{click:t.getQNaireStatics}},[t._v("查看填写情况")]),i("Modal",{attrs:{title:"结束任务"},on:{"on-ok":t.finishTask},model:{value:t.showFinishDialog,callback:function(e){t.showFinishDialog=e},expression:"showFinishDialog"}},[i("p",[t._v("确定结束任务吗？")])])],1):i("div",{staticClass:"submit-btn-wrapper"},[i("Button",{staticStyle:{"margin-right":"1rem"}},[t._v("重置")]),i("Button",{attrs:{type:"primary"},on:{click:t.createQuestionnaire}},[t._v("提交")])],1)],1)},r=[],o=(i("7f7f"),i("0d6d"),i("96cf"),i("3b8d")),a=i("d225"),s=i("b0b4"),u=i("308d"),c=i("6bb5"),l=i("4e2b"),d=i("9ab4"),p=i("60a3"),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Form",{ref:"questionForm",staticClass:"question-creater",attrs:{"label-position":"right","label-width":90,model:t.content,rules:t.rules}},[i("FormItem",{attrs:{label:"题目",prop:"title"}},[i("Input",{attrs:{type:"text",disabled:"edit"===t.mode&&!t.editAllow,placeholder:"输入题目"},model:{value:t.content.title,callback:function(e){t.$set(t.content,"title",e)},expression:"content.title"}})],1),i("FormItem",{attrs:{label:"题目类型"}},[i("RadioGroup",{model:{value:t.content.type,callback:function(e){t.$set(t.content,"type",e)},expression:"content.type"}},[i("Radio",{attrs:{label:1,disabled:"edit"===t.mode&&!t.editAllow}},[t._v("单选")]),i("Radio",{attrs:{label:2,disabled:"edit"===t.mode&&!t.editAllow}},[t._v("多选")]),i("Radio",{attrs:{label:3,disabled:"edit"===t.mode&&!t.editAllow}},[t._v("填空")])],1)],1),i("FormItem",{attrs:{label:"是否必须填写"}},[i("RadioGroup",{model:{value:t.isOptional,callback:function(e){t.isOptional=e},expression:"isOptional"}},[i("Radio",{attrs:{label:1,disabled:"edit"===t.mode&&!t.editAllow}},[t._v("是")]),i("Radio",{attrs:{label:0,disabled:"edit"===t.mode&&!t.editAllow}},[t._v("否")])],1)],1),2===t.content.type?i("FormItem",{attrs:{label:"填写数量限制"}},[i("Slider",{attrs:{disabled:"edit"===t.mode&&!t.editAllow,max:t.content.options.length},model:{value:t.content.limit,callback:function(e){t.$set(t.content,"limit",e)},expression:"content.limit"}})],1):t._e(),3!==t.content.type?i("FormItem",{attrs:{label:"选项","label-position":"top",prop:"options"}},[t._l(t.content.options,function(e,n){return i("div",{key:n,staticClass:"option-wrapper",staticStyle:{"margin-bottom":"8px"}},[i("Input",{attrs:{type:"text",disabled:"edit"===t.mode&&!t.editAllow},model:{value:t.content.options[n],callback:function(e){t.$set(t.content.options,n,e)},expression:"content.options[idx]"}}),"edit"!==t.mode||t.editAllow?i("Button",{staticStyle:{"padding-right":"8px","padding-left":"8px","margin-left":"2px"},attrs:{type:"text",icon:"md-close"},on:{click:function(e){return t.delOption(n)}}}):t._e()],1)}),i("Button",{attrs:{disabled:"edit"===t.mode&&!t.editAllow},on:{click:t.addNewOption}},[t._v("添加")])],2):t._e(),i("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{id:"q-submit"}},["edit"===t.mode?i("Button",{staticStyle:{"margin-right":"1rem"},on:{click:function(e){t.editAllow=!t.editAllow}}},[t._v("\n      "+t._s(t.editAllow?"正在编辑":"编辑")+"\n    ")]):t._e(),i("Button",{attrs:{type:"primary",disabled:"edit"===t.mode&&!t.editAllow},on:{click:t.submitQuestion}},[t._v("提交")])],1)],1)},h=[],f=(i("c5f6"),i("ac6a"),function(t){function e(){var t;return Object(a["a"])(this,e),t=Object(u["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.content={title:"",type:1,options:[],optional:!0,limit:1,answer:[]},t.editAllow=!1,t.rules={title:[{required:!0,message:"题目不能为空",trigger:"blur"}],options:[{required:!0,message:"选项不能为空",validator:function(e,i,n){3!==t.content.type&&0===i.length?n(new Error("选项不能为空")):n()}}]},t}return Object(l["a"])(e,t),Object(s["a"])(e,[{key:"addNewOption",value:function(){this.content.options.push("new options")}},{key:"delOption",value:function(t){this.content.options.splice(t,1)}},{key:"submitQuestion",value:function(){var t=this;this.$refs.questionForm.validate(function(e){e&&(t.$Notice.success({title:"成功",duration:2}),"create"===t.mode?(t.$emit("createNewQuestion",Object.assign({},t.content)),t.clear(),t.content.options=[]):(t.editAllow=!1,t.$emit("modifyQuestion",Object.freeze(t.content),t.index)))})}},{key:"clear",value:function(){var t=this;this.content.title=this.inputContent.title,this.content.type=this.inputContent.type,this.content.optional=this.inputContent.optional,this.content.limit=this.inputContent.limit,this.inputContent.options.forEach(function(e){t.content.options.push(e)})}},{key:"mounted",value:function(){this.clear()}},{key:"isOptional",get:function(){return this.content.optional?1:0},set:function(t){this.content.optional=1===t}}]),e}(p["d"]));d["a"]([Object(p["c"])({required:!0})],f.prototype,"inputContent",void 0),d["a"]([Object(p["c"])({required:!0,type:String})],f.prototype,"mode",void 0),d["a"]([Object(p["c"])({required:!1,type:Number})],f.prototype,"index",void 0),f=d["a"]([Object(p["a"])({name:"question-form"})],f);var b=f,y=b,v=(i("ba69"),i("2877")),w=Object(v["a"])(y,m,h,!1,null,null,null),g=w.exports,x=i("5d0f"),k=i("e519"),Q=i("9bc5"),$=function(t){function e(){var t;return Object(a["a"])(this,e),t=Object(u["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.showCreaterDialog=!1,t.showFinishDialog=!1,t.questionnaireExisted=!1,t.plainContent={title:"",type:1,options:[],optional:!0,limit:1,answer:[]},t.currentQuestionnaire={title:"",publisher_id:-1,summary:"",bounty:0,content:[],type:"TASK_TYPE_SURVEY",limit:1},t}return Object(l["a"])(e,t),Object(s["a"])(e,[{key:"newQuestionHandler",value:function(t){this.showCreaterDialog=!1,this.currentQuestionnaire.content&&this.currentQuestionnaire.content.push(t)}},{key:"modifyQuestionHandler",value:function(t,e){this.currentQuestionnaire.content&&(this.currentQuestionnaire.content[e]=t)}},{key:"createQuestion",value:function(){this.showCreaterDialog=!0}},{key:"createQuestionnaire",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(0!==this.currentQuestionnaire.title.length){t.next=5;break}return this.$Notice.error({title:"标题不能为空",duration:2}),t.abrupt("return");case 5:if(0!==this.currentQuestionnaire.summary.length){t.next=10;break}return this.$Notice.error({title:"描述不能为空",duration:2}),t.abrupt("return");case 10:if(!this.currentQuestionnaire.content||0!==this.currentQuestionnaire.content.length){t.next=15;break}return this.$Notice.error({title:"题目不能为空",duration:2}),t.abrupt("return");case 15:return t.next=17,this.$store.dispatch("questionnaire/".concat(k["h"]),Object.freeze({title:this.currentQuestionnaire.title,summary:this.currentQuestionnaire.summary,limit:this.currentQuestionnaire.limit,type:this.currentQuestionnaire.type,content:this.currentQuestionnaire.content,reward:this.currentQuestionnaire.bounty}));case 17:e=t.sent,"OK"===e?(this.$Notice.success({title:"发布成功",duration:2}),this.clear(),this.$router.push({name:"tasks"})):this.$Notice.error({title:e,duration:2});case 19:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"delQuestion",value:function(t){this.currentQuestionnaire.content&&this.currentQuestionnaire.content.splice(t,1)}},{key:"clear",value:function(){this.currentQuestionnaire={title:"",publisher_id:-1,summary:"",bounty:0,content:[],type:"TASK_TYPE_SURVEY",limit:1}}},{key:"mounted",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(-1,null!==this.$store.getters["user/".concat(x["b"])]&&(this.currentQuestionnaire.publisher_id=this.$store.getters["user/".concat(x["b"])].uid),"published-questionnaire-detail"!==this.$route.name){t.next=7;break}return t.next=5,this.$store.dispatch("questionnaire/".concat(k["d"]),this.$route.params.aid);case 5:this.currentQuestionnaire=this.$store.getters["questionnaire/".concat(k["a"])],this.questionnaireExisted=!0;case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"getQNaireStatics",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("questionnaire/".concat(k["e"]),this.$route.params.aid);case 2:this.$store.getters["questionnaire/".concat(k["i"])]?this.$router.push({name:"questionnaire-statistics",params:{aid:this.$route.params.aid}}):this.$Notice.error({title:"暂时无人填写问卷",duration:2});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"finishTask",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("task/".concat(Q["a"]),this.$route.params.aid);case 2:e=t.sent,"OK"===e?(this.$Notice.success({title:"操作成功"}),this.$router.push({name:"a-published"})):this.$Notice.error({title:e&&e.msg||"fail"});case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}]),e}(p["d"]);$=d["a"]([Object(p["a"])({name:"publish-questionnaire",components:{QuestionForm:g}})],$);var _=$,O=_,S=(i("b177"),Object(v["a"])(O,n,r,!1,null,"27f47e69",null));e["default"]=S.exports},"0d6d":function(t,e,i){var n=i("d3f4"),r=i("67ab").onFreeze;i("5eda")("freeze",function(t){return function(e){return t&&n(e)?t(r(e)):e}})},"12f5":function(t,e,i){},"67ab":function(t,e,i){var n=i("ca5a")("meta"),r=i("d3f4"),o=i("69a8"),a=i("86cc").f,s=0,u=Object.isExtensible||function(){return!0},c=!i("79e5")(function(){return u(Object.preventExtensions({}))}),l=function(t){a(t,n,{value:{i:"O"+ ++s,w:{}}})},d=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[n].i},p=function(t,e){if(!o(t,n)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[n].w},m=function(t){return c&&h.NEED&&u(t)&&!o(t,n)&&l(t),t},h=t.exports={KEY:n,NEED:!1,fastKey:d,getWeak:p,onFreeze:m}},"8ed2b":function(t,e,i){},b177:function(t,e,i){"use strict";var n=i("12f5"),r=i.n(n);r.a},ba69:function(t,e,i){"use strict";var n=i("8ed2b"),r=i.n(n);r.a}}]);
//# sourceMappingURL=chunk-7b7a0b08.6d7fbf99.js.map