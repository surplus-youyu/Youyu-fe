(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6607dda0"],{"4c64":function(t,e,n){},"7bf4":function(t,e,n){"use strict";var i=n("acda"),r=n.n(i);r.a},"8f07":function(t,e,n){"use strict";var i=n("4c64"),r=n.n(i);r.a},acda:function(t,e,n){},cddc:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"current-questionnaire"}},[n("h1",{staticStyle:{"margin-top":"1rem","margin-bottom":"1rem","text-align":"center"}},[t._v(t._s(t.currentQuestionnaire.title))]),n("div",{staticClass:"title-wrapper"},[n("h3",{staticStyle:{margin:"1rem 0 1rem 0"}},[t._v("问卷描述")]),n("p",{staticStyle:{width:"45%","min-width":"400px","max-width":"500px"}},[t._v(t._s(t.currentQuestionnaire.summary))])]),n("div",{staticClass:"limit-wrapper"},[n("h3",{staticStyle:{margin:"1rem 0 1rem 0"}},[t._v("已认领")]),n("p",{staticStyle:{width:"45%","min-width":"400px","max-width":"500px","text-align":"left"}},[t._v(t._s(t.currentQuestionnaire.assigned)+" / "+t._s(t.currentQuestionnaire.limit))])]),t._m(0),t._l(t.currentQuestionnaire.content,function(e,i){return n("answer-sheet",{key:"content-questionnaire-"+i,ref:"answer",refInFor:!0,attrs:{inputQuestion:e,index:i,readonly:t.readonly}})}),t.readonly?n("div",{staticClass:"submit-btn-wrapper"},[n("Button",{on:{click:t.acceptAndAnswer}},[t._v("接受并任务并开始填写")])],1):n("div",{staticClass:"submit-btn-wrapper"},[n("Button",{on:{click:t.submit}},[t._v("提交")])],1)],2)},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title-wrapper"},[n("h3",{staticStyle:{margin:"1rem 0 0 0"}},[t._v("问题")])])}],a=(n("c5f6"),n("7f7f"),n("ac6a"),n("96cf"),n("3b8d")),s=n("d225"),o=n("b0b4"),u=n("308d"),c=n("6bb5"),l=n("4e2b"),p=n("9ab4"),h=n("60a3"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{staticClass:"answer-sheet",staticStyle:{margin:"1rem auto 0 auto",width:"45%","min-width":"400px","max-width":"500px"},attrs:{"dis-hover":""}},[1===t.inputQuestion.type?n("Form",{ref:"single",attrs:{rules:t.singleChoiceRule,model:t.answer}},[n("p",[t._v(t._s(t.inputQuestion.title))]),n("Label",{staticStyle:{"margin-top":"1rem",display:"inline-block"}},[t._v("单选")]),n("FormItem",{attrs:{prop:"radio"}},[n("RadioGroup",{on:{"on-change":t.radioChange},model:{value:t.answer.radio,callback:function(e){t.$set(t.answer,"radio",e)},expression:"answer.radio"}},t._l(t.inputQuestion.options,function(e,i){return n("Radio",{key:"option-"+(e+i),staticClass:"single-selection-form",attrs:{disabled:t.readonly,label:i,prop:"single"}},[t._v("\n          "+t._s(e)+"\n        ")])}),1)],1)],1):2===t.inputQuestion.type?n("Form",{ref:"multi",attrs:{rules:t.multiChoiceRule,model:t.answer}},[n("p",[t._v(t._s(t.inputQuestion.title))]),n("Label",{staticStyle:{"margin-top":"1rem",display:"inline-block"}},[t._v("多选："+t._s(t.inputQuestion.limit))]),n("FormItem",{attrs:{prop:"checkBox"}},[n("CheckboxGroup",{on:{"on-change":t.checkboxChange},model:{value:t.answer.checkBox,callback:function(e){t.$set(t.answer,"checkBox",e)},expression:"answer.checkBox"}},t._l(t.inputQuestion.options,function(e,i){return n("Checkbox",{key:"option-multi-"+(e+i),staticClass:"multi-selection-form",attrs:{disabled:t.readonly,label:i}},[t._v("\n          "+t._s(e)+"\n        ")])}),1)],1)],1):n("Form",{ref:"input",attrs:{rules:t.inputRule,model:t.answer}},[n("p",{staticStyle:{width:"45%","min-width":"400px","max-width":"500px"}},[t._v(t._s(t.inputQuestion.title))]),n("FormItem",{attrs:{prop:"input"}},[n("Input",{staticClass:"input-form",attrs:{disabled:t.readonly,placeholder:"输入答案"},on:{"on-change":t.inputChange},model:{value:t.answer.input,callback:function(e){t.$set(t.answer,"input",e)},expression:"answer.input"}})],1)],1)],1)},m=[],f=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(u["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.answer={radio:-1,checkBox:[],input:""},t.singleChoiceRule={radio:[{validator:function(e,n,i){t.inputQuestion.optional&&-1===n?i(new Error("选项不能为空")):i()},trigger:"change"}]},t.multiChoiceRule={checkBox:[{validator:function(e,n,i){t.inputQuestion.optional&&0===n.length?i(new Error("选项不能为空")):t.inputQuestion.limit<n.length?i(new Error("选项超过题目限制")):i()},trigger:"change"}]},t.inputRule={input:[{validator:function(e,n,i){t.inputQuestion.optional&&0===n.length?i(new Error("选项不能为空")):i()},trigger:"blur"}]},t}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"radioChange",value:function(t){this.inputQuestion.answer=[this.inputQuestion.options[t]]}},{key:"checkboxChange",value:function(t){var e=this;this.inputQuestion.answer=t.map(function(t){return e.inputQuestion.options[t]})}},{key:"inputChange",value:function(t){this.inputQuestion.answer=[this.answer.input]}},{key:"validate",value:function(){var t=!1;return 1===this.inputQuestion.type?this.$refs.single.validate(function(e){t=e||!1}):2===this.inputQuestion.type?this.$refs.multi.validate(function(e){t=e||!1}):this.$refs.input.validate(function(e){t=e||!1}),t}}]),e}(h["d"]);p["a"]([Object(h["c"])({required:!0})],f.prototype,"inputQuestion",void 0),p["a"]([Object(h["c"])({required:!0,type:Number})],f.prototype,"index",void 0),p["a"]([Object(h["c"])({required:!0,type:Boolean})],f.prototype,"readonly",void 0),f=p["a"]([Object(h["a"])({name:"answer-sheet"})],f);var v=f,w=v,b=(n("7bf4"),n("2877")),g=Object(b["a"])(w,d,m,!1,null,null,null),y=g.exports,x=n("e519"),k=n("afe4"),_=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(u["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.currentQuestionnaire={title:"",publisher_id:-1,summary:"",bounty:0,content:[],type:"TASK_TYPE_SURVEY",limit:1,assigned:1},t}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"submit",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$refs.answer,n=!0,e.forEach(function(t,e){t.validate()||(n=!1)}),n){t.next=7;break}this.$Notice.error({title:"不满足问卷填写要求，无法提交",duration:2}),t.next=11;break;case 7:return t.next=9,this.$store.dispatch("assignment/".concat(k["d"]),{aid:this.$route.params.aid,payload:this.currentQuestionnaire.content});case 9:i=t.sent,"OK"===i?this.$Notice.success({title:"success"}):this.$Notice.error({title:"fail"});case 11:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,n,i,r,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if("view-questionnaire"!==this.$route.name){t.next=7;break}return t.next=3,this.$store.dispatch("questionnaire/".concat(x["d"]),this.$route.params.sid);case 3:e=this.$store.getters["questionnaire/".concat(x["a"])],this.currentQuestionnaire=JSON.parse(JSON.stringify(e)),t.next=16;break;case 7:return t.next=9,this.$store.dispatch("assignment/".concat(k["b"]));case 9:return n=this.$store.getters["assignment/".concat(k["a"])],i=-1,n.forEach(function(t){String(t.id)===a.$route.params.aid&&(i=t.task_id)}),t.next=14,this.$store.dispatch("questionnaire/".concat(x["d"]),i);case 14:r=this.$store.getters["questionnaire/".concat(x["a"])],this.currentQuestionnaire=JSON.parse(JSON.stringify(r));case 16:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"acceptAndAnswer",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("questionnaire/".concat(x["j"]),{task_id:this.$route.params.sid});case 2:e=t.sent,isNaN(Number(e))?this.$Notice.error({title:e.data.msg||"fail"}):this.$router.push({name:"answer-questionnaire",params:{aid:e}});case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"readonly",get:function(){return"view-questionnaire"===this.$route.name}}]),e}(h["d"]);_=p["a"]([Object(h["a"])({name:"survey",components:{AnswerSheet:y},beforeRouteUpdate:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e,n,i){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if("view-questionnaire"!==this.$route.name||e.params.sid===n.params.sid){t.next=3;break}return t.next=3,this.$store.dispatch("questionnaire/".concat(x["d"]),e.params.sid);case 3:i();case 4:case"end":return t.stop()}},t,this)}));function e(e,n,i){return t.apply(this,arguments)}return e}()})],_);var $=_,Q=$,O=(n("8f07"),Object(b["a"])(Q,i,r,!1,null,"30f35f5e",null));e["default"]=O.exports}}]);
//# sourceMappingURL=chunk-6607dda0.939b51d1.js.map